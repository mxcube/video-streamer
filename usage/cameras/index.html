<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://github.com/mxcube/video-streamer/usage/cameras/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Cameras - MXCuBE Video-Streamer</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">MXCuBE Video-Streamer</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../about/" class="nav-link">About</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Developers Guidelines</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../devs/contributing/" class="dropdown-item">Contributing</a>
</li>
                                    
<li>
    <a href="../../devs/documentation/" class="dropdown-item">Documentation</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../../installation/" class="nav-link">Installation</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Usage</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Cameras</a>
</li>
                                    
<li>
    <a href="../setup/" class="dropdown-item">Setup</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../../faq/" class="nav-link">FAQ</a>
                            </li>
                            <li class="nav-item">
                                <a href="../../license/" class="nav-link">License</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                            <li class="nav-item">
                                <a rel="prev" href="../../installation/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../setup/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#cameras" class="nav-link">Cameras</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#the-input-uri" class="nav-link">The Input URI</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#testcamera" class="nav-link">TestCamera</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#videotestcamera" class="nav-link">VideoTestCamera</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#limacamera" class="nav-link">LimaCamera</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#mjpegcamera" class="nav-link">MJPEGCamera</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#rediscamera" class="nav-link">RedisCamera</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="cameras">Cameras</h1>
<p>Our streamer supports a variety of camera types, each designed to meet different streaming needs and setups. In this section, we provide an overview of the available camera types and how to configure the streamer depending on the type you use.</p>
<h2 id="the-input-uri">The Input URI</h2>
<p>The streamer automatically selects the appropriate mode for the camera based on the <code>input_uri</code> parameter (see <a href="../setup/">setup</a> for instructions on how to configure this parameter). The table below provides an overview of how the <code>input_uri</code> should be structured for each camera type:</p>
<table>
<thead>
<tr>
<th>Camera</th>
<th>Uri</th>
</tr>
</thead>
<tbody>
<tr>
<td>TestCamera</td>
<td><code>test</code></td>
</tr>
<tr>
<td>VideoTestCamera</td>
<td><code>videotest</code></td>
</tr>
<tr>
<td>MJPEGCamera</td>
<td>Should start with <code>http://</code> and include host and port, e.g. <code>http://localhost:8000</code></td>
</tr>
<tr>
<td>RedisCamera</td>
<td>Should start with <code>redis://</code> and include host and port of redis server, e.g. <code>redis://localhost:6379</code></td>
</tr>
<tr>
<td>LimaCamera</td>
<td>URI of the Tango (Lima) device</td>
</tr>
<tr>
<td>---</td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="testcamera">TestCamera</h2>
<p>The <code>TestCamera</code> is the simplest type of camera, continuously streaming the same static image. As a result, the generated stream displays a fixed image. To change the displayed image, replace the <code>fakeimg.jpg</code> file located in <code>/video_streamer/core</code>. Useful for testing, debugging and mockup versions of your application.</p>
<hr />
<h2 id="videotestcamera">VideoTestCamera</h2>
<p>Similar to the <code>TestCamera</code>, this type of camera generates a stream from a prerecorded video instead of a static image. The video plays in an infinite loop. To change the video, replace the <code>testvideo.avi</code> file located in <code>video-streamer/core</code>. Ensure that the video is either uncompressed or compressed using the MJPEG codec; otherwise, the camera may encounter issues when reading the frames.</p>
<hr />
<h2 id="limacamera">LimaCamera</h2>
<p>The <code>LimaCamera</code> supports streaming from a Tango (Lima) device. by polling the images from the devices <code>uri</code> and converting them into a stream in either <em>MJPEG</em> or <em>MPEG1</em> format. If no camera is specified, according to the input URI table defined <a href="#the-input-uri">above</a> the application will automatically select this camera type. </p>
<hr />
<h2 id="mjpegcamera">MJPEGCamera</h2>
<p>The <code>MJPEGCamera</code> provides specialized support for <em>MJPEG</em> video streams. It is designed to fetch images from an <em>MJPEG</em> stream, such as those from a web camera or a streaming url.</p>
<blockquote>
<p><strong>Note</strong>: Currently the <code>MJPEGCamera</code> is the only camera that does not support conversion to a <code>Redis</code> Pub/Sub channel (more about streaming on a <a href="../setup/#dual-streaming-seamlessly-serve-mjpeg-and-redis-pubsub-video-feeds">redis channel</a>)</p>
</blockquote>
<h4 id="authentication-for-mjpeg-streams">Authentication for MJPEG Streams</h4>
<p>Some MJPEG streams may require authentication to access. To support such scenarios, the <code>MJPEGCamera</code> class includes built-in authentication support. Currently, both <code>Basic</code> and <code>Digest</code> authentication methods are supported.</p>
<p>Below is an example of how to use the video-streamer to access a stream requiring <code>Basic</code> authentication:</p>
<pre><code class="language-bash">video-streamer -of MPEG1 -uri &lt;stream_url&gt; -auth Basic -user &lt;username&gt; -pass &lt;password&gt;
</code></pre>
<h5 id="explanation-of-the-parameters">Explanation of the Parameters:</h5>
<ul>
<li><code>-of</code>: Specifies the ouput format, here <code>MPEG1</code> is used.</li>
<li><code>-uri</code>: The URL of the MJPEG stream.</li>
<li><code>-auth</code>: Specifies the authentication method (<code>Basic</code> or <code>Digest</code>)</li>
<li><code>-user</code>: The username for authentication</li>
<li><code>-pass</code>: The password required for authentication</li>
</ul>
<p>Replace <code>&lt;stream_url&gt;</code>, <code>&lt;username&gt;</code> and <code>&lt;password&gt;</code> with the appropriate values for your stream. Ensure you handle credentials securely and avoid exposing them in public or shared scripts!</p>
<hr />
<h2 id="rediscamera">RedisCamera</h2>
<p><a href="https://redis.io/">Redis</a> Pub/Sub (Publish/Subscribe) is a messaging paradigm where publishers send messages to specific channels, and subscribers receive messages from the channels they are subscribed to. It is commonly used for real-time communication between applications or components.</p>
<p>Instead of using a real camera, the <code>video-streamer</code> allows to use said <code>Redis</code> Pub/Sub channel to create a stream in MPEG1 or MJPEG format.</p>
<h4 id="command-line-example">Command Line Example</h4>
<p>To use the <code>RedisCamera</code>, one can use the following command:</p>
<pre><code class="language-bash">video-streamer -d -of MPEG1 -uri redis://[host]:[port] -irc ExampleStream
</code></pre>
<p>where <code>host</code> and <code>port</code> are the respective host and port of the <code>Redis</code> server and <code>ExampleStream</code> would be the Pub/Sub channel to use for generating the stream. </p>
<h4 id="correct-format-for-redis-camera">Correct Format for Redis Camera</h4>
<p>For the Camera to pick up your images and correctly format them into a stream in MJPEG or MPEG1 format. You should publish each image as a dictionary containing the <code>base64</code> encoded image data and the image size.</p>
<pre><code class="language-python">    image_dict = {
        &quot;data&quot;: [base64 encoded image],
        &quot;size&quot;: [image size],
    }
</code></pre>
<h4 id="example-redis-pubsub-communication">Example Redis Pub/Sub communication</h4>
<p>The following script is an example on how to send a stream via <code>Redis</code> Pub/Sub channel, so that the <code>video-streamer</code> can pick it up. </p>
<pre><code class="language-python">import redis
import time
from PIL import Image
import io
import base64
import json

REDIS_HOST = 'localhost'
REDIS_PORT = 6379
CHANNEL_NAME = 'ExampleStream'
IMAGE_PATH = './fakeimg.jpg' # path to your test image, adjust if necessary
PUBLISH_INTERVAL = 0.1

def load_image_as_bytes(image_path):
    &quot;&quot;&quot;Load an image and convert it to bytes.&quot;&quot;&quot;
    with Image.open(image_path) as img:
        size = (img.height, img.width)
        byte_stream = io.BytesIO()
        img.save(byte_stream, format=img.format)
        return byte_stream.getvalue(), size

def main():
    # Connect to Redis
    redis_client = redis.Redis(host=REDIS_HOST, port=REDIS_PORT)

    # Load image as bytes and use correct format for the video-streamer
    image_data, image_size = load_image_as_bytes(IMAGE_PATH)
    image_dict = {
        &quot;data&quot;: base64.b64encode(image_data).decode(&quot;utf-8&quot;),
        &quot;size&quot;: image_size,
    }
    try:
        while True:
            redis_client.publish(CHANNEL_NAME, json.dumps(image_dict))
            time.sleep(PUBLISH_INTERVAL)
    except KeyboardInterrupt:
        print(&quot;Stopped publishing.&quot;)

if __name__ == '__main__':
    main()

</code></pre>
<p>This script sends a <em>jpeg</em> image with a frame rate of 10 frames per second to the <code>ExampleStream</code> channel. With a <code>Redis</code> server running on <code>localhost:6379</code></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
